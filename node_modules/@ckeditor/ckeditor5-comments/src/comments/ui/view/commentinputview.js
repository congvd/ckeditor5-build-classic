/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{View as bt,ViewCollection as Bt,FocusCycler as Et,ButtonView as _0x5668c7}from'ckeditor5/src/ui';import{FocusTracker as _0xda74fd,KeystrokeHandler as pt}from'ckeditor5/src/utils';import{icons as Ot}from'ckeditor5/src/core';import St from'../commenteditor/commenteditor';export default class xt extends bt{constructor(_0x5ff9f8,_0x5398c4={}){super(_0x5ff9f8);const {t:t}=_0x5ff9f8;this['editor']=new St(_0x5398c4),this['keystrokes']=new pt(),this['focusTracker']=new _0xda74fd(),this['set']('value',_0x5398c4['initialData']||''),this['set']('disabledSubmit',!0x1),this['set']('showButtons',!0x0),this['set']('placeholder',t('Reply...')),this['submitButtonView']=this['_createSubmitButton'](),this['cancelButtonView']=this['_createCancelButton'](),this['setTemplate']({'tag':'div','attributes':{'class':['ck-comment__input-wrapper']},'children':[{'tag':'div','attributes':{'class':['ck-comment__input-actions',this['bindTemplate']['if']('showButtons','ck-comment__input-actions--active')]},'children':[this['submitButtonView'],this['cancelButtonView']]}]}),this['keystrokes']['set']('Esc',(_0xad49c1,_0x4f2919)=>{this['cancelButtonView']['fire']('execute'),_0x4f2919();}),this['on']('submit',(_0x5b21ec,_0x9d92a0)=>{_0x9d92a0['length']>0xfa0?(alert(t({'string':'Comment\x20content\x20is\x20too\x20long.\x20Your\x20comment\x20has\x20%0\x20characters\x20but\x20the\x20limit\x20is\x20%1\x20characters.','id':'TOO_LONG_COMMENT_ALERT'},[_0x9d92a0['length'],0xfa0])),_0x5b21ec['stop']()):this['editor']['setData']('');},{'priority':'high'});}['render'](){super['render']();const {editor:_0x1b84aa,element:_0x495653}=this;this['keystrokes']['listenTo'](_0x495653),this['focusTracker']['add'](_0x495653),this['_editorCreationPromise']=_0x1b84aa['create']()['then'](()=>{_0x495653['insertBefore'](_0x1b84aa['ui']['element'],_0x495653['firstChild']),_0x1b84aa['model']['document']['on']('change',()=>this['value']=_0x1b84aa['getData']()),_0x1b84aa['bind']('placeholder')['to'](this),this['_initializeFocusCycling'](_0x1b84aa),this['fire']('editorReady');});}['focus'](){this['editor']['focus']();}async['destroy'](){this['_isDestroyed']||(this['_isDestroyed']=!0x0,this['isRendered']&&(await this['_editorCreationPromise'],await this['editor']['destroy']()),await super['destroy']());}['_createSubmitButton'](){const _0x5c9ca4=new _0x5668c7(this['locale']),{t:t}=this['locale'];return _0x5c9ca4['extendTemplate']({'attributes':{'class':['ck-comment__input-actions--submit']}}),_0x5c9ca4['label']=t('Submit'),_0x5c9ca4['icon']=Ot['check'],_0x5c9ca4['on']('execute',()=>{this['fire']('submit',this['value']);}),_0x5c9ca4['bind']('isEnabled')['to'](this,'value',this,'disabledSubmit',(_0x385c7d,_0x5e7b27)=>!_0x5e7b27&&!!_0x385c7d['trim']()),_0x5c9ca4;}['_createCancelButton'](){const _0x321edf=new _0x5668c7(this['locale']),{t:t}=this['locale'];return _0x321edf['extendTemplate']({'attributes':{'class':['ck-comment__input-actions--cancel']}}),_0x321edf['label']=t('Cancel'),_0x321edf['icon']=Ot['cancel'],_0x321edf['on']('execute',()=>{this['editor']['setData'](''),this['fire']('cancel');}),_0x321edf;}['_initializeFocusCycling'](_0x2cc861){const _0x57fd09=this['focusTracker'],_0x487c53=new Bt();[_0x2cc861['ui']['view'],this['submitButtonView'],this['cancelButtonView']]['forEach'](_0x1aaa52=>{_0x487c53['add'](_0x1aaa52),_0x57fd09['add'](_0x1aaa52['element']);});const _0x1f7391=new Et({'focusables':_0x487c53,'focusTracker':_0x57fd09});this['keystrokes']['set']('tab',(_0x346dd1,_0x445c7d)=>{_0x1f7391['focusNext'](),_0x445c7d();},{'priority':'low'}),this['keystrokes']['set']('shift\x20+\x20tab',(_0x5f0a5f,_0x807e0d)=>{_0x1f7391['focusPrevious'](),_0x807e0d();},{'priority':'low'});}}