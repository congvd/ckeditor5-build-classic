/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x1a46=['selection','innerView','function','pluginName','EditorAnnotations','focusTracker','keys','map','blur','fire','annotation','update','cancel','addSourceCollector','isEqual','add','element','editing','isReadOnly','collection','remove','getRanges','init','sort','change:range','containsRange','delete','view','range','set','hasDomSelection','model','isCollapsed','from','_editorAnnotationsData','document','change:isFocused','push','getOrderedSelectedAnnotations','listenTo','has','requires','plugins','_dataCollectors','refreshSelectedViews','uiUpdate','editor'];(function(_0x28f7ec,_0x1a467c){const _0x21f5df=function(_0x3186bb){while(--_0x3186bb){_0x28f7ec['push'](_0x28f7ec['shift']());}};_0x21f5df(++_0x1a467c);}(_0x1a46,0x110));const _0x21f5=function(_0x28f7ec,_0x1a467c){_0x28f7ec=_0x28f7ec-0x0;let _0x21f5df=_0x1a46[_0x28f7ec];return _0x21f5df;};import{Plugin as _0xca0081}from'ckeditor5/src/core';import{CKEditorError as _0x5ded23}from'ckeditor5/src/utils';import{debounce as _0x28c0e4}from'lodash-es';import _0x151144 from'./annotations';export default class q extends _0xca0081{static get[_0x21f5('0x4')](){return[_0x151144];}static get[_0x21f5('0xd')](){return _0x21f5('0xe');}constructor(_0x29f59f){super(_0x29f59f),this[_0x21f5('0x6')]=new Set();}[_0x21f5('0x20')](){const _0x356d33=this[_0x21f5('0x9')],_0x55041b=_0x356d33[_0x21f5('0x5')]['get'](_0x151144),_0x249af9=_0x356d33['model'][_0x21f5('0x2d')][_0x21f5('0xa')],_0x3697a=_0x28c0e4(()=>this[_0x21f5('0x7')](),0xa);_0x249af9['on'](_0x21f5('0x22'),(_0x51156a,_0x31df6e)=>{_0x31df6e['directChange']&&(_0x3697a[_0x21f5('0x16')](),this[_0x21f5('0x7')]());}),this[_0x21f5('0x2')](_0x356d33['editing'][_0x21f5('0x25')][_0x21f5('0x2d')],_0x21f5('0x2e'),(_0x2d11fc,_0x2a598c,_0x464b29)=>{_0x464b29&&_0x3697a();}),this[_0x21f5('0x2')](_0x356d33['ui'][_0x21f5('0xf')],_0x21f5('0x2e'),(_0x18abe2,_0x2da4dd,_0x25ba96)=>{_0x25ba96||_0x356d33[_0x21f5('0x1c')]||this[_0x21f5('0x13')](_0x21f5('0x12'),{'isAnnotationTracked':_0x2d8d35=>this[_0x21f5('0x2c')][_0x21f5('0x3')](_0x2d8d35[_0x21f5('0xb')])});}),this[_0x21f5('0x2')](this[_0x21f5('0x9')]['ui'],_0x21f5('0x15'),()=>this['fire'](_0x21f5('0x8')));const _0x15f2f5=new Set();this[_0x21f5('0x2')](_0x55041b[_0x21f5('0x1d')],_0x21f5('0x19'),(_0x4bce0e,_0x19fe6b)=>{for(const _0x187b02 of this['_editorAnnotationsData'][_0x21f5('0x10')]())if(_0x187b02===_0x19fe6b[_0x21f5('0xb')]){_0x356d33['ui'][_0x21f5('0xf')][_0x21f5('0x19')](_0x19fe6b[_0x21f5('0x25')][_0x21f5('0x1a')]),_0x15f2f5[_0x21f5('0x19')](_0x19fe6b['view']);break;}}),this[_0x21f5('0x2')](_0x55041b['collection'],_0x21f5('0x1e'),(_0x365f24,_0x9d38a7)=>{_0x15f2f5['has'](_0x9d38a7[_0x21f5('0x25')])&&(_0x356d33['ui'][_0x21f5('0xf')][_0x21f5('0x1e')](_0x9d38a7[_0x21f5('0x25')][_0x21f5('0x1a')]),_0x15f2f5[_0x21f5('0x24')](_0x9d38a7[_0x21f5('0x25')]));});}[_0x21f5('0x28')](){return this[_0x21f5('0x9')][_0x21f5('0x1b')][_0x21f5('0x25')]['hasDomSelection'];}[_0x21f5('0x17')](_0x54d3cf){if(_0x21f5('0xc')!=typeof _0x54d3cf)throw new _0x5ded23('editorannotations-invalid-source-callback');this[_0x21f5('0x6')][_0x21f5('0x19')](_0x54d3cf);}[_0x21f5('0x7')](){this['fire']('refresh');}[_0x21f5('0x1')]({activeAnnotation:_0x5bf313,annotations:_0x1a1cdb}){const _0x3d602f=[],_0x1497a6=this[_0x21f5('0x9')][_0x21f5('0x29')][_0x21f5('0x2d')][_0x21f5('0xa')],_0x225da2=Array[_0x21f5('0x2b')](_0x1497a6[_0x21f5('0x1f')]());for(const [_0x3737be,_0x24c2dd]of this['_editorAnnotationsData']){const _0x105023=_0x673991(_0x24c2dd),_0x5a11eb=_0x1a1cdb['getByInnerView'](_0x3737be);_0x105023&&_0x5a11eb&&_0x3d602f[_0x21f5('0x0')]({'annotation':_0x5a11eb,'range':_0x105023});}function _0x673991(_0x52a2d7){for(const _0x384c49 of _0x52a2d7)for(const _0x580465 of _0x225da2)if(_0x384c49[_0x21f5('0x23')](_0x580465,!_0x1497a6[_0x21f5('0x2a')]))return _0x384c49;return null;}return _0x3d602f[_0x21f5('0x21')]((_0x29088e,_0x484c4b)=>{const _0x7fdd48=_0x29088e[_0x21f5('0x26')],_0x28ecfd=_0x484c4b['range'];if(!_0x7fdd48[_0x21f5('0x18')](_0x28ecfd)){if(_0x7fdd48[_0x21f5('0x23')](_0x28ecfd,!0x0))return 0x1;if(_0x28ecfd['containsRange'](_0x7fdd48,!0x0))return-0x1;}return _0x29088e[_0x21f5('0x14')]==_0x5bf313?-0x1:_0x484c4b[_0x21f5('0x14')]==_0x5bf313?0x1:0x0;})[_0x21f5('0x11')](_0x4e1e0e=>_0x4e1e0e['annotation']);}get[_0x21f5('0x2c')](){const _0x34139f=new Map();for(const _0x5cbf05 of Array[_0x21f5('0x2b')](this[_0x21f5('0x6')]))for(const [_0x400bf6,_0x2b3a8f]of _0x5cbf05())_0x34139f[_0x21f5('0x27')](_0x400bf6,_0x2b3a8f);return _0x34139f;}}