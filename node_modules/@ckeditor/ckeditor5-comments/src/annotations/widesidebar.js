/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x4464=['_detachFromContainer','editors','uiUpdate','resize','high','EditorAnnotations','get','rearrange','setActiveAnnotation','switchTo','_activeAnnotation','focus','plugins','cancel','register','init','_destroyEditorAnnotationsIntegration','_annotations','updateTargetRect','stopListening','context','_editorAnnotations','attach','removeEventListener','activeAnnotation','stop','detach','listenTo','widesidebar-attach-already-attached','off','set','refreshPositioning','getOrderedSelectedAnnotations','ck-sidebar--wide','widesidebar-detach-not-attached','wideSidebar','container','WideSidebar','has','_integrateWithEditorAnnotations','addAnnotation','isAttached','add','pluginName','refresh','_throttledPositioningRefresh','remove','Sidebar','blur'];(function(_0x2ed3ac,_0x4464a5){const _0xa16c35=function(_0x55b305){while(--_0x55b305){_0x2ed3ac['push'](_0x2ed3ac['shift']());}};_0xa16c35(++_0x4464a5);}(_0x4464,0x128));const _0xa16c=function(_0x2ed3ac,_0x4464a5){_0x2ed3ac=_0x2ed3ac-0x0;let _0xa16c35=_0x4464[_0x2ed3ac];return _0xa16c35;};import{ContextPlugin as _0x1d3aac}from'ckeditor5/src/core';import _0x9e1b42 from'./annotationsuis';import _0x5de4ce from'./sidebar';import{CKEditorError as _0x54dd27,Collection as _0x29e50d}from'ckeditor5/src/utils';import{throttle as _0x48c338}from'lodash-es';export default class i extends _0x1d3aac{static get['requires'](){return[_0x5de4ce,_0x9e1b42];}static get[_0xa16c('0x29')](){return _0xa16c('0x23');}constructor(_0x107c4f){super(_0x107c4f),this[_0xa16c('0x27')]=!0x1,this[_0xa16c('0x1c')](_0xa16c('0x16'),null),this['_annotations']=null,this['_editorAnnotations']=new _0x29e50d(),this[_0xa16c('0x2b')]=_0x48c338(()=>{this[_0xa16c('0xf')][_0xa16c('0x1d')]();},0x190,{'leading':!0x1});}[_0xa16c('0xd')](){const _0x27f27f=this['context']['plugins'][_0xa16c('0x4')](_0x9e1b42),_0x4f56b7=this[_0xa16c('0x12')][_0xa16c('0xa')][_0xa16c('0x4')](_0x5de4ce);_0x27f27f[_0xa16c('0xc')](_0xa16c('0x21'),this),_0x4f56b7[_0xa16c('0x22')]&&_0x27f27f[_0xa16c('0x7')](_0xa16c('0x21'));}[_0xa16c('0x6')](_0x1ae405){if(_0x1ae405===this[_0xa16c('0x16')])return;const _0x12b4bd=this[_0xa16c('0x12')][_0xa16c('0xa')][_0xa16c('0x4')](_0x5de4ce);_0x12b4bd[_0xa16c('0x8')]=_0x1ae405;const _0x4a2433=this[_0xa16c('0x16')];this[_0xa16c('0x16')]=_0x1ae405,_0x12b4bd[_0xa16c('0x2a')]({'blurredAnnotation':_0x4a2433,'activatedAnnotation':this[_0xa16c('0x16')]});}[_0xa16c('0x14')](_0x4757c9){this[_0xa16c('0xf')]=_0x4757c9;const _0x1d78ba=this['context'][_0xa16c('0xa')][_0xa16c('0x4')](_0xa16c('0x2d'));if(_0x1d78ba[_0xa16c('0xf')]=_0x4757c9,this[_0xa16c('0x27')])throw new _0x54dd27(_0xa16c('0x1a'),this);this['isAttached']=!0x0,this[_0xa16c('0x19')](_0x1d78ba,'set:container',()=>{this[_0xa16c('0x18')](),this['listenTo'](_0x1d78ba,'change:container',_0x408f87=>{_0x408f87[_0xa16c('0x1b')](),this[_0xa16c('0x14')](_0x4757c9);});}),_0x1d78ba['_attachToContainer']({'viewClass':_0xa16c('0x1f')});const _0x1b5afa=_0x4849b5=>{_0x4849b5[_0xa16c('0x10')](),_0x1d78ba[_0xa16c('0x26')](_0x4849b5);};for(const _0x45fca9 of _0x4757c9)_0x1b5afa(_0x45fca9);this[_0xa16c('0x19')](_0x4757c9,_0xa16c('0x28'),(_0x144841,_0x3c4403)=>{_0x1b5afa(_0x3c4403);}),this['listenTo'](_0x4757c9,_0xa16c('0x2c'),(_0x1622d5,_0x16cbe3,_0x4fb22d)=>{_0x1d78ba[_0xa16c('0x5')]({'removedAnnotation':_0x16cbe3,'previousAnnotation':_0x4757c9[_0xa16c('0x4')](_0x4fb22d-0x1),'nextAnnotation':_0x4757c9[_0xa16c('0x4')](_0x4fb22d+0x1)}),_0x16cbe3===this[_0xa16c('0x16')]&&this[_0xa16c('0x6')](null);},{'priority':_0xa16c('0x2')}),this[_0xa16c('0x19')](_0x4757c9,_0xa16c('0x9'),(_0x53e009,_0x3a033d)=>{this['setActiveAnnotation'](_0x3a033d);}),this[_0xa16c('0x19')](_0x4757c9,_0xa16c('0x2e'),()=>{this['setActiveAnnotation'](null);});const _0xc37079=this[_0xa16c('0x12')][_0xa16c('0x30')]?this['context'][_0xa16c('0x30')]:new _0x29e50d([this['context']]);for(const _0x5eacb0 of _0xc37079)this[_0xa16c('0x25')](_0x5eacb0);this[_0xa16c('0x19')](_0xc37079,_0xa16c('0x28'),(_0x25b1d5,_0x36c6c1)=>{this[_0xa16c('0x19')](_0x36c6c1,'ready',()=>{this[_0xa16c('0x25')](_0x36c6c1);});}),this[_0xa16c('0x19')](_0xc37079,'remove',(_0x26a91d,_0x45b593)=>{_0x45b593[_0xa16c('0xa')][_0xa16c('0x24')](_0xa16c('0x3'))&&this['_destroyEditorAnnotationsIntegration'](_0x45b593[_0xa16c('0xa')][_0xa16c('0x4')](_0xa16c('0x3')));}),window['addEventListener']('resize',this[_0xa16c('0x2b')]),this[_0xa16c('0xf')][_0xa16c('0x1d')]();}[_0xa16c('0x18')](){if(!this[_0xa16c('0x27')])throw new _0x54dd27(_0xa16c('0x20'),this);this[_0xa16c('0x6')](null);const _0x5277da=this[_0xa16c('0x12')]['plugins']['get'](_0x5de4ce);_0x5277da[_0xa16c('0x2f')](this[_0xa16c('0xf')]),this[_0xa16c('0x11')](_0x5277da),this[_0xa16c('0x11')](this[_0xa16c('0xf')]),this['stopListening'](this['context'][_0xa16c('0x30')]);for(const _0x40a713 of Array['from'](this[_0xa16c('0x13')]))this[_0xa16c('0xe')](_0x40a713);window[_0xa16c('0x15')](_0xa16c('0x1'),this['_throttledPositioningRefresh']),this['_throttledPositioningRefresh'][_0xa16c('0xb')](),this[_0xa16c('0x16')]=null,this[_0xa16c('0x27')]=!0x1;}['destroy'](){this[_0xa16c('0x27')]&&this[_0xa16c('0x18')]();}[_0xa16c('0x25')](_0x50fd23){const _0x385619=_0x50fd23[_0xa16c('0xa')]['get'](_0xa16c('0x3'));if(!_0x385619)return;const _0x35eecc=()=>{const _0xab059c=_0x385619[_0xa16c('0x1e')]({'annotations':this[_0xa16c('0xf')],'activeAnnotation':this['activeAnnotation']});this['setActiveAnnotation'](_0xab059c[0x0]||null);};this[_0xa16c('0x19')](_0x385619,_0xa16c('0x2a'),_0x35eecc),this[_0xa16c('0x19')](_0x385619,_0xa16c('0x2e'),(_0x16da81,{isAnnotationTracked:_0x321f02})=>{this[_0xa16c('0x16')]&&_0x321f02(this[_0xa16c('0x16')])&&this[_0xa16c('0x6')](null);}),this[_0xa16c('0x19')](_0x385619,_0xa16c('0x0'),()=>{this['_annotations'][_0xa16c('0x1d')]();}),this[_0xa16c('0x19')](this[_0xa16c('0xf')],_0xa16c('0x2e'),_0x46edb0=>{_0x385619['hasDomSelection']()&&(_0x35eecc(),_0x46edb0[_0xa16c('0x17')]());},{'priority':'high'}),this[_0xa16c('0x13')][_0xa16c('0x28')](_0x385619);}['_destroyEditorAnnotationsIntegration'](_0x541500){_0x541500&&(this[_0xa16c('0x11')](_0x541500),this[_0xa16c('0x13')][_0xa16c('0x2c')](_0x541500));}}