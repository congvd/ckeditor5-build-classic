/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x395f=['narrowsidebar-attach-already-attached','_manuallyClosedAnnotationViews','destroy','values','setActiveAnnotation','stop','Esc','from','_detachFromContainer','_showBalloon','ready','refresh','set:container','contains','isDirty','_annotationToNarrowView','_refreshPositioning','hasDomSelection','plugins','low','refreshPositioning','uiUpdate','add','_selectedAnnotations','_domEmitter','_attachListeners','number','get','element','target','content','_hideBalloon','esc','view','keydown','high','_throttledRefreshPositioning','_editorAnnotations','remove','addAnnotation','set','_integrateWithEditorAnnotations','create','southArrowNorthWest','narrowsidebar-detach-not-attached','resize','init','balloonPanelView','context','change:height','activeAnnotation','listenTo','bodyCollection','delete','editors','NarrowSidebar','has','includes','getByView','unpin','rearrange','northArrowSouthWest','isVisible','isAttached','EditorAnnotations','_updateBalloonPosition','_annotations','blur','getOrderedSelectedAnnotations','clear','addEventListener','first','Sidebar','focus','length','attachToDom','ck-sidebar--narrow','stopListening','_destroyEditorAnnotationsIntegration','locale','defaultPositions','attach','mousedown','_setSelectedAnnotations','detach','narrowSidebar','cancel','keyCode','_detachListeners','preventDefault','off','preventClosingBalloon','_attachToContainer'];(function(_0x17b535,_0x395faa){const _0x5bfe9f=function(_0x946aa8){while(--_0x946aa8){_0x17b535['push'](_0x17b535['shift']());}};_0x5bfe9f(++_0x395faa);}(_0x395f,0xc7));const _0x5bfe=function(_0x17b535,_0x395faa){_0x17b535=_0x17b535-0x0;let _0x5bfe9f=_0x395f[_0x17b535];return _0x5bfe9f;};import{ContextPlugin as _0x206f62}from'ckeditor5/src/core';import _0x112c7f from'./annotationsuis';import _0x4c6b1b from'./sidebar';import _0x24c787 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x2ad89f,BodyCollection as _0x3ec2fe}from'ckeditor5/src/ui';import{CKEditorError as _0x1fe7b4,DomEmitterMixin as _0xcf3066,keyCodes as _0x3e6dc0,Collection as _0x47fc8e}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{throttle as _0x35bafd}from'lodash-es';export default class s extends _0x206f62{static get['requires'](){return[_0x4c6b1b,_0x112c7f];}static get['pluginName'](){return _0x5bfe('0x2a');}constructor(_0x47d66c){super(_0x47d66c),this[_0x5bfe('0x32')]=!0x1,this[_0x5bfe('0x51')]=new Set(),this[_0x5bfe('0xb')]=Object[_0x5bfe('0x1d')](_0xcf3066),this[_0x5bfe('0x2')]=new Map(),this[_0x5bfe('0x1b')](_0x5bfe('0x25'),null),this['_annotations']=null,this[_0x5bfe('0xa')]=[],this[_0x5bfe('0x18')]=new _0x47fc8e(),this[_0x5bfe('0x17')]=_0x35bafd(()=>{this[_0x5bfe('0x3')]();},0x190,{'leading':!0x1});}[_0x5bfe('0x21')](){this[_0x5bfe('0x23')][_0x5bfe('0x5')][_0x5bfe('0xe')](_0x112c7f)['register'](_0x5bfe('0x48'),this),this[_0x5bfe('0x27')]=new _0x3ec2fe(this['context']['locale']),this[_0x5bfe('0x22')]=new _0x2ad89f(this[_0x5bfe('0x23')][_0x5bfe('0x42')]),this[_0x5bfe('0x27')][_0x5bfe('0x3e')](),this[_0x5bfe('0x27')][_0x5bfe('0x9')](this[_0x5bfe('0x22')]);}[_0x5bfe('0x44')](_0xae21de){this[_0x5bfe('0x35')]=_0xae21de;const _0xc714c6=this[_0x5bfe('0x23')][_0x5bfe('0x5')]['get'](_0x4c6b1b),_0x36cc1e=this['balloonPanelView'];if(_0xc714c6[_0x5bfe('0x35')]=_0xae21de,this[_0x5bfe('0x32')])throw new _0x1fe7b4(_0x5bfe('0x50'),this);this[_0x5bfe('0x32')]=!0x0,this['listenTo'](_0xc714c6,_0x5bfe('0x5c'),()=>{this[_0x5bfe('0x47')](),this[_0x5bfe('0x26')](_0xc714c6,'change:container',_0xfda0e2=>{_0xfda0e2[_0x5bfe('0x4d')](),this[_0x5bfe('0x44')](_0xae21de);});}),_0xc714c6[_0x5bfe('0x4f')]({'viewClass':_0x5bfe('0x3f'),'spaceBetweenItems':0x5});const _0x673076=_0x4238db=>{const _0x23df4b=new _0x24c787(this[_0x5bfe('0x23')][_0x5bfe('0x42')]);_0xc714c6[_0x5bfe('0x1a')](_0x4238db,_0x23df4b),this[_0x5bfe('0x2')]['set'](_0x4238db,_0x23df4b),_0x23df4b['bind'](_0x5bfe('0x1'),'annotationType',_0x5bfe('0xd'))['to'](_0x4238db['view'],_0x5bfe('0x1'),'type',_0x5bfe('0x3d')),_0x23df4b['on']('execute',()=>{this[_0x5bfe('0x51')]['clear'](),_0x36cc1e[_0x5bfe('0x11')][_0x5bfe('0x3a')]!==_0x4238db['view']?(this[_0x5bfe('0x59')](_0x4238db),_0x4238db[_0x5bfe('0x14')][_0x5bfe('0xf')][_0x5bfe('0x3c')](),this[_0x5bfe('0x54')](_0x4238db)):this['setActiveAnnotation'](null);});};for(const _0xc94912 of _0xae21de)_0x673076(_0xc94912);this[_0x5bfe('0x26')](_0xae21de,_0x5bfe('0x9'),(_0x7ff5df,_0x36f588)=>{_0x673076(_0x36f588);}),this[_0x5bfe('0x26')](_0xae21de,'remove',(_0x215d1b,_0x6b939b,_0x5e07ba)=>{this['_annotationToNarrowView']['get'](_0x6b939b)[_0x5bfe('0x52')](),this[_0x5bfe('0x2')][_0x5bfe('0x28')](_0x6b939b),_0xc714c6[_0x5bfe('0x2f')]({'removedAnnotation':_0x6b939b,'previousAnnotation':_0xae21de[_0x5bfe('0xe')](_0x5e07ba-0x1),'nextAnnotation':_0xae21de[_0x5bfe('0xe')](_0x5e07ba+0x1)}),_0x6b939b===this[_0x5bfe('0x25')]&&this[_0x5bfe('0x54')](null);},{'priority':_0x5bfe('0x6')}),this[_0x5bfe('0x26')](_0xae21de,_0x5bfe('0x3c'),(_0x3c094b,_0x257e98)=>{this[_0x5bfe('0x54')](_0x257e98);}),this[_0x5bfe('0x26')](_0xae21de,_0x5bfe('0x36'),()=>{this[_0x5bfe('0x54')](null);}),this[_0x5bfe('0xb')][_0x5bfe('0x26')](document,_0x5bfe('0x15'),(_0x180070,_0x212bd6)=>{_0x212bd6[_0x5bfe('0x4a')]===_0x3e6dc0[_0x5bfe('0x13')]&&_0x36cc1e[_0x5bfe('0x31')]&&(this[_0x5bfe('0x51')][_0x5bfe('0x9')](_0x36cc1e[_0x5bfe('0x11')][_0x5bfe('0x3a')]),this[_0x5bfe('0x12')](),_0x212bd6['stopPropagation'](),_0x212bd6[_0x5bfe('0x4c')]());}),this[_0x5bfe('0xb')][_0x5bfe('0x26')](document,_0x5bfe('0x45'),(_0x52ab83,_0x367ee7)=>{const _0x4e1967=_0x367ee7[_0x5bfe('0x10')];_0x36cc1e[_0x5bfe('0x31')]&&_0x36cc1e['element'][_0x5bfe('0x0')](_0x4e1967)||_0xc714c6[_0x5bfe('0x14')][_0x5bfe('0xf')][_0x5bfe('0x0')](_0x4e1967)||_0x52ab83[_0x5bfe('0x4e')]||(this[_0x5bfe('0x51')]['clear'](),this['_hideBalloon'](),this[_0x5bfe('0x54')](null));});const _0x446db7=this[_0x5bfe('0x23')][_0x5bfe('0x29')]?this[_0x5bfe('0x23')][_0x5bfe('0x29')]:new _0x47fc8e([this[_0x5bfe('0x23')]]);for(const _0x372945 of _0x446db7)this[_0x5bfe('0x1c')](_0x372945);this[_0x5bfe('0x26')](_0x446db7,_0x5bfe('0x9'),(_0x23073e,_0x199bdd)=>{this[_0x5bfe('0x26')](_0x199bdd,_0x5bfe('0x5a'),()=>{this[_0x5bfe('0x1c')](_0x199bdd);});}),this[_0x5bfe('0x26')](_0x446db7,_0x5bfe('0x19'),(_0x1db5b8,_0x12684f)=>{_0x12684f[_0x5bfe('0x5')][_0x5bfe('0x2b')](_0x5bfe('0x33'))&&this[_0x5bfe('0x41')](_0x12684f[_0x5bfe('0x5')][_0x5bfe('0xe')](_0x5bfe('0x33')));}),window[_0x5bfe('0x39')]('resize',this['_throttledRefreshPositioning']),this[_0x5bfe('0x3')]();}[_0x5bfe('0x54')](_0x35c990){if(_0x35c990===this['activeAnnotation'])return;const _0x45fe98=this['context'][_0x5bfe('0x5')][_0x5bfe('0xe')](_0x5bfe('0x3b'));if(_0x45fe98[_0x5bfe('0x5b')]({'blurredAnnotation':this['activeAnnotation'],'activatedAnnotation':_0x35c990,'disableAnimationOnActivatedAnnotation':!0x0}),_0x35c990)_0x45fe98['getSidebarItemView'](_0x35c990)?this['_showBalloon'](_0x35c990):this[_0x5bfe('0x12')]();else this[_0x5bfe('0x12')]();this[_0x5bfe('0x25')]=_0x35c990;}['detach'](){if(!this[_0x5bfe('0x32')])throw new _0x1fe7b4(_0x5bfe('0x1f'),this);this[_0x5bfe('0x54')](null);const _0x23163b=this[_0x5bfe('0x23')][_0x5bfe('0x5')]['get']('Sidebar');this[_0x5bfe('0x12')](),Array[_0x5bfe('0x57')](this[_0x5bfe('0x2')][_0x5bfe('0x53')](),_0x134991=>_0x134991['destroy']()),this[_0x5bfe('0x2')][_0x5bfe('0x38')](),_0x23163b[_0x5bfe('0x58')](this[_0x5bfe('0x35')]),this[_0x5bfe('0x40')](),this['_domEmitter'][_0x5bfe('0x40')](),this[_0x5bfe('0x40')](this['context'][_0x5bfe('0x29')]);for(const _0x2e90b1 of Array[_0x5bfe('0x57')](this['_editorAnnotations']))this[_0x5bfe('0x41')](_0x2e90b1);window['removeEventListener'](_0x5bfe('0x20'),this[_0x5bfe('0x17')]),this[_0x5bfe('0x17')][_0x5bfe('0x49')](),this[_0x5bfe('0xa')]=[],this[_0x5bfe('0x32')]=!0x1,this['_annotations']=null;}[_0x5bfe('0x52')](){this[_0x5bfe('0x32')]&&this[_0x5bfe('0x47')](),this[_0x5bfe('0x27')]['detachFromDom']();}['_integrateWithEditorAnnotations'](_0x42800f){const _0x3354b9=_0x42800f[_0x5bfe('0x5')][_0x5bfe('0xe')](_0x5bfe('0x33')),_0x1be37e=this[_0x5bfe('0x23')][_0x5bfe('0x5')][_0x5bfe('0xe')](_0x4c6b1b),_0x115825=this[_0x5bfe('0x35')],_0x4a216c=this[_0x5bfe('0x22')],_0x466755=()=>{const _0x37e24e=_0x3354b9[_0x5bfe('0x37')]({'activeAnnotation':this['activeAnnotation'],'annotations':this[_0x5bfe('0x35')]});this['_setSelectedAnnotations'](_0x37e24e),this[_0x5bfe('0x54')](_0x37e24e[0x0]||null);};this[_0x5bfe('0x26')](_0x3354b9,_0x5bfe('0x5b'),_0x466755),this[_0x5bfe('0x26')](_0x3354b9,_0x5bfe('0x36'),(_0x4edaca,{isAnnotationTracked:_0x5bb06f})=>{this[_0x5bfe('0x25')]&&_0x5bb06f(this[_0x5bfe('0x25')])&&(this['_setSelectedAnnotations']([]),this[_0x5bfe('0x54')](null));}),this[_0x5bfe('0x26')](_0x3354b9,_0x5bfe('0x8'),()=>{this['_throttledRefreshPositioning']();}),this[_0x5bfe('0x26')](_0x115825,_0x5bfe('0x36'),_0x16faa7=>{_0x3354b9[_0x5bfe('0x4')]()&&_0x16faa7[_0x5bfe('0x55')]();},{'priority':_0x5bfe('0x16')}),this[_0x5bfe('0xb')][_0x5bfe('0x26')](document,_0x5bfe('0x45'),(_0x1278be,_0x3aadd1)=>{const _0x471f09=_0x3aadd1[_0x5bfe('0x10')];_0x4a216c[_0x5bfe('0x31')]&&_0x4a216c[_0x5bfe('0xf')][_0x5bfe('0x0')](_0x471f09)||_0x1be37e[_0x5bfe('0x14')]['element']['contains'](_0x471f09)||this[_0x5bfe('0x25')]&&_0x3354b9['hasDomSelection']()&&(_0x466755(),_0x1278be[_0x5bfe('0x4e')]=!0x0);},{'priority':'high'}),this[_0x5bfe('0x18')][_0x5bfe('0x9')](_0x3354b9);}[_0x5bfe('0x41')](_0x41b758){_0x41b758&&(this['stopListening'](_0x41b758),this[_0x5bfe('0x18')][_0x5bfe('0x19')](_0x41b758));}[_0x5bfe('0x46')](_0x12653b){for(const _0x46e4e2 of this[_0x5bfe('0xa')])_0x12653b[_0x5bfe('0x2c')](_0x46e4e2)||this[_0x5bfe('0x51')]['delete'](_0x46e4e2[_0x5bfe('0x14')]);this['_selectedAnnotations']=_0x12653b;}[_0x5bfe('0x3')](){const _0x49b289=this[_0x5bfe('0x22')];this[_0x5bfe('0x35')][_0x5bfe('0x7')](),_0x49b289['isVisible']&&this[_0x5bfe('0x34')]();}[_0x5bfe('0x59')](_0x4025ce){if(this[_0x5bfe('0x51')][_0x5bfe('0x2b')](_0x4025ce[_0x5bfe('0x14')]))return;const _0x117145=this[_0x5bfe('0x22')]['content'][_0x5bfe('0x3a')];_0x117145!==_0x4025ce[_0x5bfe('0x14')]?(_0x117145&&this[_0x5bfe('0x4b')](_0x117145),this[_0x5bfe('0xc')](_0x4025ce[_0x5bfe('0x14')]),this[_0x5bfe('0x22')][_0x5bfe('0x11')][_0x5bfe('0x38')](),this[_0x5bfe('0x22')][_0x5bfe('0x11')][_0x5bfe('0x9')](_0x4025ce['view']),this[_0x5bfe('0x34')]()):this[_0x5bfe('0x34')]();}[_0x5bfe('0x34')](){const _0x479624=this['balloonPanelView']['content'][_0x5bfe('0x3a')],_0x1c8af7=this['_annotations'][_0x5bfe('0x2d')](_0x479624);if(!this['_annotationToNarrowView']['has'](_0x1c8af7))return;const _0x3eb682=this[_0x5bfe('0x2')]['get'](_0x1c8af7)[_0x5bfe('0xf')],_0x4c6b19=function(){const _0x1c7131=_0x2ad89f[_0x5bfe('0x43')];return[_0x1c7131['southArrowNorthEast'],_0x1c7131['northArrowSouthEast'],_0x1c7131['southArrowNorth'],_0x1c7131['northArrowSouth'],_0x1c7131[_0x5bfe('0x1e')],_0x1c7131[_0x5bfe('0x30')]];}();this[_0x5bfe('0x22')]['pin']({'target':_0x3eb682,'positions':_0x4c6b19});}[_0x5bfe('0x12')](){const _0x16a5b1=this['balloonPanelView'],_0xf129e8=_0x16a5b1[_0x5bfe('0x11')][_0x5bfe('0x3a')];_0xf129e8&&(this[_0x5bfe('0x4b')](_0xf129e8),_0x16a5b1[_0x5bfe('0x2e')](),_0x16a5b1[_0x5bfe('0x11')][_0x5bfe('0x38')]());}[_0x5bfe('0xc')](_0x1d3944){this[_0x5bfe('0x26')](_0x1d3944,_0x5bfe('0x24'),()=>this[_0x5bfe('0x34')]()),this[_0x5bfe('0x26')](_0x1d3944,_0x5bfe('0x56'),(_0x4d54c8,_0x5a369e)=>{this[_0x5bfe('0x51')][_0x5bfe('0x9')](_0x1d3944),this[_0x5bfe('0x12')](),_0x5a369e();});}['_detachListeners'](_0x9d50db){this['stopListening'](_0x9d50db);}}